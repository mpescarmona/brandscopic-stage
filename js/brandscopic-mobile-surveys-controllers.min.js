function eventsSurveysParentController($scope,surveysService){"use strict";$scope.gendersList=surveysService.genders,$scope.racesList=surveysService.races,$scope.agesList=surveysService.ages,$scope.likehoodList=surveysService.likehood,$scope.genderModel={genderSelected:""},$scope.raceModel={raceSelected:""},$scope.ageModel={ageSelected:""},$scope.questions={},$scope.questions.brandsQuestion1=[],$scope.questions.brandsQuestion2=[],$scope.questions.brandsQuestion3=[],$scope.questions.brandsQuestion4=[],surveysService.getBrandslist().then(function(response){$scope.brandslist=response,angular.forEach(response,function(brand){$scope.questions.brandsQuestion1.push({id:0,brand_id:brand.id,question_id:1,name:brand.name,model:brand.id+"_model"}),$scope.questions.brandsQuestion2.push({id:0,brand_id:brand.id,question_id:2,name:brand.name,model:brand.id+"_model",input_id:"question2"+brand.id}),$scope.questions.brandsQuestion3.push({id:0,brand_id:brand.id,question_id:3,name:brand.name,model:brand.id+"_model",input_id:"question3"+brand.id}),$scope.questions.brandsQuestion4.push({id:0,brand_id:brand.id,question_id:4,name:brand.name,model:brand.id+"_model",input_id:"question4"+brand.id})})},function(response){console.log(response)})}eventsSurveysParentController.$inject=["$scope","surveysService"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,$stateParams,$location,snapRemote,UserService,CompanyService,UserInterface,surveysService,Event){if(!UserService.isLogged())return void $state.go("login");snapRemote.close();var canCreateSurvey,ui={hasMenuIcon:!1,hasDeleteIcon:!1,hasBackIcon:!0,hasMagnifierIcon:!1,hasAddIcon:!0,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,showEventSubNav:!0,hasCustomHomeClass:!1,searching:!1,eventSubNav:"surveys",AddIconState:"home.events.details.surveys.add",hasAddPhoto:!1},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,event_id:$stateParams.eventId},actions={success:function(event){$scope.event=event,ui.title=event.campaign?event.campaign.name:"Surveys",$scope.UserInterface=UserInterface,$scope.eventId=$stateParams.eventId,angular.extend(UserInterface,ui),angular.forEach($scope.event.actions,function(item){canCreateSurvey=item.indexOf("conduct surveys"),-1!=canCreateSurvey&&(UserInterface.hasAddIcon=!0)})}};$scope.customPermissionsHandler=function(){ui.hasAddIcon=UserService.permissionIsValid("events_create_surveys"),angular.extend(UserInterface,ui)},$scope.getObservableProperties=function(){return["suveySumaryList"]},Event.find(credentials,actions),$scope.showSurveys=!1,surveysService.getSurveysList().then(function(response){response.length>0&&($scope.showSurveys=!0),$scope.suveySumaryList=[],angular.forEach(response,function(items){var _age="",_race="",_gender="";angular.forEach(items.surveys_answers,function(item){if(null!=item.kpi_id)switch(item.kpi_id){case 6:_gender="10"==item.answer?"Male":"Female";break;case 7:switch(item.answer){case"1":_age="Less 12";break;case"2":_age="12 - 17";break;case"387":_age="18 - 20";break;case"3":_age="21 - 24";break;case"4":_age="25 - 34";break;case"5":_age="35 - 44";break;case"6":_age="45 - 54";break;case"7":_age="55 - 64";break;case"8":_age="More than 65"}case 8:switch(item.answer){case"11":_race="Asian";break;case"12":_racee="Black / African American";break;case"13":_race="Hispanic / Latino";break;case"14":_race="Native American";break;case"15":_race="White"}}}),$scope.suveySumaryList.push({id:items.id,age:_age,race:_race,gender:_gender,create:items.created_at,update:items.updated_at})})}),$scope.editSurvey=function(survey_id){$location.path("/home/events/"+$scope.eventId+"/surveys/"+survey_id+"/edit")}};module.controller("eventsSurveysController",controller).$inject=["$scope","$state","$stateParams","$location","snapRemote","UserService","CompanyService","UserInterface","surveysService","Event"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,$stateParams,$location,snapRemote,UserService,CompanyService,surveysService,UserInterface,Event){if(!UserService.isLogged())return void $state.go("login");angular.extend(this,new eventsSurveysParentController($scope,surveysService)),snapRemote.close(),$scope.permissionsProvider="eventSurveysAddPermissionsService";var ui={title:"Survey",hasMenuIcon:!1,hasDeleteIcon:!0,hasBackIcon:!1,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!0,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,showEventSubNav:!0,searching:!1,eventSubNav:"surveys",AddIconState:"",hasAddPhoto:!1},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,event_id:$stateParams.eventId},actions={success:function(event){$scope.event=event,angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface,$scope.eventId=$stateParams.eventId,$scope.createSurvey=function(){var surveyModel={survey:{surveys_answers_attributes:[]}};surveyModel.survey.surveys_answers_attributes.push({kpi_id:6,answer:$scope.genderModel.genderSelected}),surveyModel.survey.surveys_answers_attributes.push({kpi_id:7,answer:$scope.ageModel.ageSelected}),surveyModel.survey.surveys_answers_attributes.push({kpi_id:8,answer:$scope.raceModel.raceSelected}),angular.forEach($scope.questions,function(questions){angular.forEach(questions,function(question){surveyModel.survey.surveys_answers_attributes.push({brand_id:question.brand_id,question_id:question.question_id,answer:question.model})})}),surveysService.createSurvey(surveyModel).then(function(response){$scope.surveyError=!1,$scope.survey=response,$location.path("/home/events/"+event.id+"/surveys")},function(response){angular.forEach(response,function(){$scope.surveyError=!0})})}}};Event.find(credentials,actions)};module.controller("eventsSurveysAddController",controller).$inject=["$scope","$state","$stateParams","$location","snapRemote","UserService","CompanyService","surveysService","UserInterface","Event","Surveys"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,$stateParams,$location,snapRemote,UserService,CompanyService,surveysService,UserInterface){function buildSurveyForEdit(surveys_answers){angular.forEach(surveys_answers,function(answer){switch(answer.kpi_id){case 6:$scope.genderModel.genderSelected=parseInt(answer.answer);break;case 7:$scope.ageModel.ageSelected=parseInt(answer.answer);break;case 8:$scope.raceModel.raceSelected=parseInt(answer.answer)}1==answer.question_id&&angular.forEach($scope.questions.brandsQuestion1,function(question1){question1.brand_id==answer.brand_id&&(question1.model=answer.answer,question1.id=answer.id)}),2==answer.question_id&&angular.forEach($scope.questions.brandsQuestion2,function(question2){question2.brand_id==answer.brand_id&&($("#question2"+answer.brand_id).val(answer.answer),question2.model=answer.answer,question2.id=answer.id)}),3==answer.question_id&&angular.forEach($scope.questions.brandsQuestion3,function(question3){question3.brand_id==answer.brand_id&&(question3.model=parseInt(answer.answer),question3.id=answer.id)}),4==answer.question_id&&angular.forEach($scope.questions.brandsQuestion4,function(question4){question4.brand_id==answer.brand_id&&(question4.model=parseInt(answer.answer),question4.id=answer.id)})})}if(!UserService.isLogged())return void $state.go("login");angular.extend(this,new eventsSurveysParentController($scope,surveysService)),snapRemote.close();{var ui={hasMenuIcon:!1,hasDeleteIcon:!1,hasBackIcon:!0,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!1,hasEditSurveyIcon:!0,hasCancelIcon:!1,hasCloseIcon:!1,showEventSubNav:!0,hasCustomHomeClass:!1,searching:!1,eventSubNav:"surveys",AddIconState:"home.events.details.surveys.edit",hasAddPhoto:!1};$stateParams.survey_id}angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface,$scope.permissionsProvider="eventSurveysEditPermissionsService",surveysService.getSurveyDetail($stateParams.surveyId).then(function(response){buildSurveyForEdit(response.surveys_answers)}),$scope.editSurvey=function(){var surveyModel={survey:{surveys_answers_attributes:[]}},arrayAnswers=[];arrayAnswers.push({kpi_id:6,answer:$scope.genderModel.genderSelected}),arrayAnswers.push({kpi_id:7,answer:$scope.ageModel.ageSelected}),arrayAnswers.push({kpi_id:8,answer:$scope.raceModel.raceSelected}),angular.forEach($scope.questions,function(questions){angular.forEach(questions,function(question){arrayAnswers.push({id:question.id,answer:question.model.toString()})})}),surveyModel.survey.surveys_answers_attributes=arrayAnswers,surveysService.editSurvey(surveyModel,$stateParams.surveyId).then(function(response){$scope.survey=response,$location.path("/home/events/"+$stateParams.eventId+"/surveys")},function(response){console.log(response)})}};module.controller("eventsSurveysEditController",controller).$inject=["$scope","$state","$stateParams","$location","snapRemote","UserService","CompanyService","surveysService","UserInterface","Event","Surveys"];