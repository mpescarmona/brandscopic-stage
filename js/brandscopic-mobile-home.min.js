var module=angular.module("brandscopicApp.controllers"),controller=function($q,$scope,$rootScope,$state,$timeout,snapRemote,$sce,UserService,UserInterface,CompanyService,Event,$location,$http,Notification,LoginManager,MinimalUi){if(!LoginManager.isLogged()){var originUrl=window.location.href,endOfAppDomain=originUrl.indexOf("app")+3,appDomainUrl=originUrl.substr(0,endOfAppDomain);return window.location=appDomainUrl+"/login/index.html",!1}LoginManager.initializeSystem(),$rootScope.showSearchField=!1,$scope.snapOptions={disable:"right"};var authToken=UserService.currentUser.auth_token,credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,"status[]":"Active"},pendingNotifications=0,notificationsQueryingPromise=null;$scope.currentCompany=CompanyService.currentCompany,$scope.UserInterface=UserInterface,$scope.UserInterface.title="Home",$scope.isEventCompleted=!0,$scope.place_reference="",$scope.logout=function(){return LoginManager.logout(authToken,function(){var originUrl=window.location.href,endOfAppDomain=originUrl.indexOf("app")+3,appDomainUrl=originUrl.substr(0,endOfAppDomain);return window.location=appDomainUrl+"/login/index.html",!1}),!1},$scope.photoForm={key:"",AWSAccessKeyId:"",policy:"",signature:""},$scope.showSearchEvent=function(isShowing){$("#searchEvent").val(""),$rootScope.showSearchField=isShowing,isShowing||$scope.$broadcast("CLOSE_SEARCH",!0),$scope.$broadcast("ALL_EVENT",isShowing)},$scope.navigationItems=[{"class":"eventIcon",label:"EVENTS",link:"#home/events",id:"eventsNavBar"},{"class":"tasksIcon",label:"TASKS",link:"#home/tasks",id:"tasksNavBar"},{"class":"venuesIcon",label:"VENUES",link:"#home/venues",id:"venuesNavBar"},{"class":"notificationIcon",label:"NOTIFICATIONS",link:"#home/notifications",showNotifications:!0,id:"notificationNavBar"},{"class":"dashboardIcon",label:"DASHBOARD",link:"#home/dashboard",id:"dashboardNavBar"}],$scope.actionItems=[{"class":"profileIcon",label:"EDIT PROFILE",link:"#home/profile",click:""},{"class":"logoutIcon",label:"LOGOUT",link:"",click:"logout()"}],$scope.$on("ADD_PHOTO",function(eventT,authForm){$scope.photoForm.AWSAccessKeyId=authForm.fields.AWSAccessKeyId,$scope.photoForm.policy=authForm.fields.policy,$scope.photoForm.signature=authForm.fields.signature,$scope.photoForm.url=authForm.url}),$scope.$on("CompanyChosen",function(event,companyId,companyName,permissions){credentials.company_id=companyId;var data=LoginManager.getCurrentSession();data.currentCompanyId=companyId,data.currentCompanyName=companyName,data.currentPermissions=permissions,LoginManager.saveSession(data),$timeout.cancel(notificationsQueryingPromise),Notification.all(credentials,notificationsActions,!0)}),$scope.$on("SEARCH_DIRECTIVE",function(event,source){$scope.source=source});var notificationsActions={success:function(notifications){pendingNotifications=notifications.length,$timeout(function(){Notification.all(credentials,notificationsActions,!0)},3e4)}};$scope.getPendingNotifications=function(){return pendingNotifications},Notification.all(credentials,notificationsActions,!0),MinimalUi.enabled=!0};module.controller("homeCtrl",controller).$inject=["$q","$scope","$rootScope","$state","$timeout","snapRemote","$sce","UserService","UserInterface","CompanyService","Event","$location","$http","Notification","LoginManager","MinimalUi"];