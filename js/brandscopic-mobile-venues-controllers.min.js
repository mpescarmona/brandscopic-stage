var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,snapRemote,UserService,CompanyService,venueService,UserInterface,Venue){if(!UserService.isLogged())return void $state.go("login");snapRemote.close(),$scope.showVenues=!1,$scope.loading=!0;var ui={title:"Venues",hasMenuIcon:!0,hasDeleteIcon:!1,hasBackIcon:!1,hasMagnifierIcon:!0,hasAddIcon:!0,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,showVenueSubNav:!0,hasCustomHomeClass:!1,searching:!1,AddIconState:"home.venues.add"},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token},options={force:!0},actions={success:function(venues){$scope.loading=!1,$scope.venuesItems=venues,$scope.venuesItems.length&&($scope.showVenues=!0),$scope.page=venues.page,angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface}};Venue.all(credentials,actions,options),$scope.$emit("SEARCH_DIRECTIVE","venues"),$scope.$on("RESULT_SEARCH",function(event,data){console.log(data);var area=[],brand=[],brand_portfolio=[],campaign=[],company_user=[],team=[];switch(data.type){case"campaign":campaign.push(data.id);break;case"brand":brand.push(data.id);break;case"brand_portfolio":brand_portfolio.push(data.id);break;case"area":area.push(data.id);break;case"company_user":company_user.push(data.id);break;case"team":team.push(data.id)}venueService.getVenuesByFilters(area,brand,brand_portfolio,campaign,company_user,team).then(function(response){$scope.venuesItems=response.results})}),$scope.$on("CLOSE_SEARCH",function(value){value&&venueService.getVenuesByFilters().then(function(response){$scope.venuesItems=response.results})}),$scope.customPermissionsHandler=function(){ui.hasAddIcon=UserService.permissionIsValid("venues_create"),angular.extend(UserInterface,ui)}};module.controller("VenuesController",controller).$inject=["$scope","$state","snapRemote","UserService","CompanyService","venueService","UserInterface","Venue"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,$location,snapRemote,CompanyService,UserService,UserInterface,Venue,Country){if(!UserService.isLogged())return void $state.go("login");snapRemote.close();var ui={title:"Venue",hasMenuIcon:!1,hasDeleteIcon:!0,hasBackIcon:!1,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!0,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,hasCustomHomeClass:!1,searching:!1};angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface,$scope.countries=[],$scope.states=[],$scope.countryCode="US",$scope.venue={},$scope.venue_error=void 0,$scope.getCountries=function(){var credentials={auth_token:UserService.currentUser.auth_token},actions={success:function(countries){$scope.countries=countries}};Country.all(credentials,actions)},$scope.getStates=function(countryId){var credentials={auth_token:UserService.currentUser.auth_token,country_id:countryId},actions={success:function(states){$scope.states=states}};Country.states(credentials,actions)},$scope.getStatesForCountry=function(){var countryCode=$scope.venue.country;$scope.getStates(countryCode)},$scope.getVenueTypes=function(){var credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token},actions={success:function(venueTypes){$scope.venueTypes=venueTypes}};Venue.types(credentials,actions)},$scope.createVenue=function(){var credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token},actions={success:function(venue){$scope.venue=venue,$location.path("/home/venues/"+venue.id+"/about")},error:function(venue_error){$scope.venue_error=venue_error}};Venue.create(credentials,actions,$scope.venue)},$scope.getCountries(),$scope.getVenueTypes()};module.controller("VenuesAddController",controller).$inject=["$scope","$state","$location","snapRemote","CompanyService","UserService","UserInterface","Venue","Country"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,$stateParams,snapRemote,CompanyService,UserService,UserInterface,Venue){if(!UserService.isLogged())return void $state.go("login");snapRemote.close();var ui={title:"Venues",hasMenuIcon:!1,hasDeleteIcon:!1,hasBackIcon:!0,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,showVenueSubNav:!0,hasCustomHomeClass:!1,searching:!1},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:$stateParams.venueId},actions={success:function(venue){ui.title=venue.name,$scope.venue=venue,angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface}};Venue.find(credentials,actions)};module.controller("VenuesDetailsController",controller).$inject=["$scope","$state","$stateParams","snapRemote","CompanyService","UserService","UserInterface","Venue"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$rootScope,$state,$stateParams,snapRemote,CompanyService,UserService,UserInterface,Venue){if(!UserService.isLogged())return void $state.go("login");snapRemote.close(),$rootScope.showSearchField=!1;var ui={},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:$stateParams.venueId},actions={success:function(venue){if(ui={title:venue.name,hasMenuIcon:!1,hasDeleteIcon:!1,hasBackIcon:!0,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,showVenueSubNav:!0,hasCustomHomeClass:!1,searching:!1,AddIconState:"home.venues.add",venueSubNav:"about"},$scope.venue=venue,angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface,$scope.opening=[],null!=venue.opening_hours)for(var item,i=0;item=venue.opening_hours[i++];)$scope.opening.push({day:item.substring(0,item.indexOf(" ")),hours:item.substring(item.indexOf(" ")+1,item.length)})}};Venue.find(credentials,actions),$scope.map_styles=[{stylers:[{hue:"#00ffe6"},{saturation:-100},{gamma:.8}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#BABABA"}]}]};module.controller("VenuesAboutController",controller).$inject=["$scope","$rootScope","$state","$stateParams","snapRemote","CompanyService","UserService","UserInterface","Venue"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$window,$state,$stateParams,snapRemote,UserService,CompanyService,UserInterface,Venue){if(!UserService.isLogged())return void $state.go("login");snapRemote.close();var ui={hasMenuIcon:!1,hasDeleteIcon:!0,hasBackIcon:!1,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,showVenueSubNav:!1,hasCustomHomeClass:!1,searching:!1,venueSubNav:"about"},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:$stateParams.venueId},actions={success:function(venue){$scope.venue=venue,ui.title=venue.name,angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface}};Venue.find(credentials,actions),$scope.map_styles=[{stylers:[{hue:"#00ffe6"},{saturation:-100},{gamma:.8}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#BABABA"}]}]};module.controller("VenuesAboutMapController",controller).$inject=["$scope","$window","$state","$stateParams","snapRemote","UserService","CompanyService","UserInterface","Venue"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,$stateParams,snapRemote,CompanyService,UserService,UserInterface,Venue){if(!UserService.isLogged())return void $state.go("login");snapRemote.close();var ui={},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:$stateParams.venueId},actions={success:function(venue){ui={title:venue.name,hasMenuIcon:!1,hasDeleteIcon:!1,hasBackIcon:!0,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,showVenueSubNav:!0,hasCustomHomeClass:!1,searching:!1,venueSubNav:"analysis"},$scope.venue=venue,angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface;var credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:venue.id},actions={success:function(analysis){$scope.analysis=analysis;var dataAgeCategories=[],dataAgeSource=[],gapAgeValue=[],ethnicData=[],impressionsPromo=[],impressionsCost=[],ageValue=0,showAge=!1;for(var key in analysis.age)dataAgeCategories.push(key),ageValue=parseInt(parseFloat(analysis.age[key]).toFixed(0)),dataAgeSource.push(analysis.age[key]?ageValue:0),gapAgeValue.push(100-(analysis.age[key]?ageValue:0)),showAge=ageValue?!0:showAge;var ethnicValue=0,showEthnicity=!1;for(var key in analysis.ethnicity)item=[],item.push(key),ethnicValue=parseInt(parseFloat(analysis.ethnicity[key]).toFixed(0)),item.push(analysis.ethnicity[key]?ethnicValue:0),ethnicData.push(item),showEthnicity=ethnicValue?!0:showEthnicity;var showTrends=!1;for(var key in analysis.trends_by_week.impressions_promo)impressionsPromo.push(analysis.trends_by_week.impressions_promo[key]?analysis.trends_by_week.impressions_promo[key]:0),showTrends=analysis.trends_by_week.impressions_promo[key]?!0:showTrends;for(var key in analysis.trends_by_week.cost_impression)impressionsCost.push(analysis.trends_by_week.cost_impression[key]?analysis.trends_by_week.cost_impression[key]:0),showTrends=analysis.trends_by_week.cost_impression[key]?!0:showTrends;$scope.ageChart={plotOptions:{bar:{dataLabels:{enabled:!1}},series:{stacking:"percent",enableMouseTracking:!1,pointPadding:0,groupPadding:0,borderWidth:0,pointWidth:15,dataLabels:{color:"#3E9CCF",style:{fontSize:"11px"}}}},options:{chart:{type:"bar"},legend:{enabled:!1},plotOptions:{series:{stacking:"percent"}},tooltip:{enabled:!1}},series:[{data:gapAgeValue,id:"Serie1",name:"Fill in",color:"#DFDFDF"},{data:dataAgeSource,id:"Serie2",name:"Values",color:"#3E9CCF",dataLabels:{enabled:!0,format:"{y}%",color:"#3E9CCF",align:"right",x:30,y:-2,style:{color:"#3E9CCF"}}}],title:{text:""},xAxis:{currentMin:null,currentMax:null,categories:dataAgeCategories,title:{enabled:!1},labels:{style:{color:"#3E9CCF",fontSize:"13px"}},tickLength:0,lineWidth:0},yAxis:{max:100,labels:{enabled:!1},title:{text:!1},gridLineColor:"transparent",enabled:!1},credits:{enabled:!1},loading:!1},$scope.ethnicityChart={plotOptions:{pie:{shadow:!1},series:{enableMouseTracking:!1,dataLabels:{connectorColor:"#C0C0C0",softConnector:!1}}},options:{chart:{type:"pie"},colors:["#347a99","#218ebf","#41AAD8","#6ebde7","#94d6ed"],title:{text:null},credits:{enabled:!1},yAxis:{title:{text:null}},tooltip:{enabled:!1}},series:[{name:"Ethnicity",data:ethnicData,size:"60%",innerSize:"30%",distance:-10,dataLabels:{crop:!1,formatter:function(){return'<span style="font-size:16px;">'+this.y+'%</span><br /><div style="width: 50px;font-size:11px;">'+this.point.name+"</div>"},color:"#3E9CCF"}}]},$scope.trendsChart={options:{chart:{marginBottom:65},legend:{enabled:!0,borderWidth:0,itemStyle:{fontSize:"10px",color:"#3E9CCF"}},tooltip:{headerFormat:"",pointFormat:"{point.y}",borderWidth:0,borderColor:"#FFF",backgroundColor:"transparent",shadow:!1,style:{fontSize:"14px"},positioner:function(labelWidth,labelHeight,point){return{x:point.plotX+this.chart.plotLeft-labelWidth/2,y:point.plotY+this.chart.plotTop-labelHeight-10}},formatter:function(){return"Cost/Impression"==this.series.name?'<span style="color:'+this.series.color+'">$'+this.y+"</span>":'<span style="color:'+this.series.color+'">'+this.y+"</span>"}},plotOptions:{series:{marker:{fillColor:"#FFFFFF",lineWidth:2,lineColor:null,radius:6,symbol:"circle"}}}},title:{text:""},subtitle:{text:""},xAxis:{categories:["MON","TUE","WED","THU","FRI","SAT","SUN"],lineColor:"#D1D1D1",tickWidth:0,labels:{style:{color:"#D1D1D1"}}},yAxis:[{id:"primary-y",title:{enabled:!1},gridLineColor:"transparent",lineWidth:1,lineColor:"#D1D1D1",labels:{style:{color:"#D1D1D1"}}},{id:"secondary-y",title:{enabled:!1},gridLineColor:"transparent",opposite:!0,lineWidth:1,lineColor:"#D1D1D1",labels:{style:{color:"#D1D1D1"}}}],legend:{enabled:!0,y:50,itemStyle:{fontSize:"10px",color:"#3E9CCF"}},series:[{name:"Impressions/promo hour",type:"line",yAxis:"primary-y",data:impressionsPromo,color:"#3D9CCA",labels:{enabled:!1}},{name:"Cost/Impression",type:"line",yAxis:"secondary-y",data:impressionsCost,color:"#94D6ED",labels:{enabled:!1}}],credits:{enabled:!1},loading:!1},$scope.showAge=showAge,$scope.showEthnicity=showEthnicity,$scope.showTrends=showTrends}};Venue.analysis(credentials,actions)}};Venue.find(credentials,actions)};module.controller("VenuesAnalysisController",controller).$inject=["$scope","$state","$stateParams","snapRemote","CompanyService","UserService","UserInterface","Venue"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,$stateParams,snapRemote,CompanyService,UserService,UserInterface,Venue){if(!UserService.isLogged())return void $state.go("login");snapRemote.close(),$scope.hasPhotos=!1,$scope.loading=!0;var ui={},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:$stateParams.venueId},actions={success:function(venue){ui={title:venue.name,hasMenuIcon:!1,hasDeleteIcon:!1,hasBackIcon:!0,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,showVenueSubNav:!0,hasCustomHomeClass:!1,searching:!1,venueSubNav:"photos"},$scope.venue=venue,angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface;var credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:venue.id},actions={success:function(photos){$scope.loading=!1,photos.length&&($scope.hasPhotos=!0),$scope.photos=photos}};Venue.photos(credentials,actions)}};Venue.find(credentials,actions)};module.controller("VenuesPhotosController",controller).$inject=["$scope","$state","$stateParams","snapRemote","CompanyService","UserService","UserInterface","Venue"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,$stateParams,snapRemote,UserService,CompanyService,UserInterface,Venue){if(!UserService.isLogged())return void $state.go("login");snapRemote.close();var ui={title:"",hasMenuIcon:!1,hasDeleteIcon:!1,hasBackIcon:!1,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!0,showEventSubNav:!1,hasCustomHomeClass:!0,CloseState:"home.venues.details.photos",searching:!1,venueSubNav:"photos",hasAddPhoto:!1},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:$stateParams.venueId},actions={success:function(venue){$scope.venue=venue;var credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:$stateParams.venueId},actions={success:function(photos){photos.length&&($scope.hasPhotos=!0),$scope.photos=photos}};Venue.photos(credentials,actions),angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface,$scope.eventId=$stateParams.eventId,$scope.direction="left",$scope.currentIndex=$stateParams.index||0,$scope.setCurrentSlideIndex=function(index){$scope.direction=index>$scope.currentIndex?"left":"right",$scope.currentIndex=index},$scope.isCurrentSlideIndex=function(index){return Number($scope.currentIndex)===index},$scope.prevSlide=function(){$scope.direction="left",$scope.currentIndex=$scope.currentIndex<$scope.photos.length-1?++$scope.currentIndex:0},$scope.nextSlide=function(){$scope.direction="right",$scope.currentIndex=$scope.currentIndex>0?--$scope.currentIndex:$scope.photos.length-1}}};Venue.find(credentials,actions)};module.controller("VenuesPhotoSliderController",controller).$inject=["$scope","$state","$stateParams","snapRemote","UserService","CompanyService","UserInterface","Venue"];var module=angular.module("brandscopicApp.controllers"),controller=function($scope,$state,$stateParams,snapRemote,CompanyService,UserService,UserInterface,Venue){if(!UserService.isLogged())return void $state.go("login");snapRemote.close(),$scope.showComments=!1,$scope.loading=!0;var ui={},credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:$stateParams.venueId},actions={success:function(venue){ui={title:venue.name,hasMenuIcon:!1,hasDeleteIcon:!1,hasBackIcon:!0,hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasCloseIcon:!1,showVenueSubNav:!0,hasCustomHomeClass:!1,searching:!1,venueSubNav:"comments"},angular.extend(UserInterface,ui),$scope.UserInterface=UserInterface;var credentials={company_id:CompanyService.getCompanyId(),auth_token:UserService.currentUser.auth_token,venue_id:$stateParams.venueId},actions={success:function(comments){comments.length&&($scope.showComments=!0),$scope.loading=!1,$scope.comments=[];for(var item,i=0;item=comments[i++];)$scope.comments.push("brandscopic"==item.type?{id:item.id,content:item.content,time:item.created_at,author:void 0,rating:void 0,type:"brandscopic"}:{id:void 0,content:item.text,time:item.time,author:item.author_name,rating:item.rating,type:"google"})}};Venue.comments(credentials,actions)}};Venue.find(credentials,actions)};module.controller("VenuesCommentsController",controller).$inject=["$scope","$state","$stateParams","snapRemote","CompanyService","UserService","UserInterface","Venue"];