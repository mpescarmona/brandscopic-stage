"use strict";angular.module("brandscopicApp",["ui.router","snap","angular-flip","ngResource","ngAnimate","ngTouch","brandscopicApp.filters","brandscopicApp.services","brandscopicApp.services.permissions","brandscopicApp.constants","brandscopicApp.directives","brandscopicApp.controllers","brandscopicApp.animations","brandscopicApp.debounce","brandscopicApp.sharedDirectives","brandscopicApp.eventDirectives","brandscopicApp.eventService","brandscopicApp.photosService","brandscopicApp.surveysService","brandscopicApp.venueService","ui.bootstrap","ngMap","model.photos","persistence.photos","model.surveys","persistence.surveys","infinite-scroll","ngStorage"]).config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/login"),$stateProvider.state("login",{url:"/login",templateUrl:"partials/login.html",controller:"LoginController"}).state("home",{url:"/home",templateUrl:"views/home.html",controller:"homeCtrl"}).state("home.companies",{url:"/companies",views:{"details@home":{templateUrl:"views/companies/companies.html",controller:"CompaniesController"}},data:{shouldRememberInHistory:!0}}).state("home.companies.select",{url:"/select",views:{"details@home":{templateUrl:"views/companies/companies_select.html",controller:"CompaniesController"}}}).state("home.dashboard",{url:"/dashboard",views:{"details@home":{templateUrl:"views/dashboard/dashboard.html",controller:"DashboardController"}},data:{shouldRememberInHistory:!0}}).state("home.dashboard.details",{url:"/:dashboardId",views:{"details@home":{templateUrl:"views/dashboard/dashboard_details.html",controller:"DashboardDetailsController"}},data:{shouldRememberInHistory:!0}}).state("home.events",{url:"/events?filter",views:{"details@home":{templateUrl:"views/events/events.html",controller:"eventsCtrl"}},data:{shouldRememberInHistory:!0},reloadOnSearch:!1}).state("home.events.add",{url:"/add",views:{"details@home":{templateUrl:"views/events/events_add.html",controller:"eventsAddCtrl"}},data:{shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details",{url:"/:eventId",views:{"details@home":{templateUrl:"views/events/events_details.html",controller:"EventsDetailsController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.edit",{url:"/edit",views:{"details@home":{templateUrl:"views/events/events_edit.html",controller:"EventsEditController"}},data:{specificParent:"home.events.details.about",shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details.about",{url:"/about",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_about.html",controller:"EventsAboutController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.map",{url:"/map",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_about_map.html",controller:"EventsAboutMapController"}},data:{shouldRememberInHistory:!1,specificParent:"home.events.details.about"}}).state("home.events.details.people",{url:"/people?show",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_people.html",controller:"EventsPeopleController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.people.contacts",{url:"/contacts","abstract":!0,data:{shouldRememberInHistory:!1}}).state("home.events.details.people.contacts.view",{url:"/:contactId/view",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_people_contacts.html",controller:"EventsPeopleContactsController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.people.contacts.add",{url:"/add",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_people_contacts_add.html",controller:"EventsPeopleContactsAddController"}},data:{specificParent:"home.events.details.people",shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details.people.contacts.edit",{url:"/:contactId/edit",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_people_contacts_edit.html",controller:"EventsPeopleContactsEditController"}},data:{specificParent:"home.events.details.people",shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details.people.contacts.new",{url:"/new",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_people_contacts_new.html",controller:"EventsPeopleContactsNewController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.people.team",{url:"/team","abstract":!0,data:{shouldRememberInHistory:!1}}).state("home.events.details.people.team.add",{url:"/add",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_people_team_add.html",controller:"EventsPeopleTeamAddController"}},data:{specificParent:"home.events.details.people",shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details.data",{url:"/data?edit",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_data.html",controller:"EventsDataController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.data.view",{url:"/view",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_data_view.html",controller:"EventsDataViewController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.comments",{url:"/comments",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_comments.html",controller:"EventsCommentsController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.comments.add",{url:"/add",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_comments_add.html",controller:"EventsCommentsAddController"}},data:{shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details.comments.edit",{url:"/:commentId/edit?content",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_comments_add.html",controller:"EventsCommentsEditController"}},data:{shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details.tasks",{url:"/tasks",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_tasks.html",controller:"EventsTasksController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.tasks.details",{url:"/:taskId/details",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_tasks_details.html",controller:"EventsTasksDetailsController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.tasks.details.edit",{url:"/edit",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_tasks_details_edit.html",controller:"EventsTasksEditController"}},data:{shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details.photos",{url:"/photos",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_photos.html",controller:"eventsPhotosCtrl"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.photos.slider",{url:"/slider/{index:.*}",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_photos_slider.html",controller:"EventsPhotoSliderController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.expenses",{url:"/expenses",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_expenses.html",controller:"EventsExpensesController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.expenses.add",{url:"/add",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_expenses_add.html",controller:"EventsExpensesAddController"}},data:{shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details.expenses.photo",{url:"/:expenseId/photo",views:{"eventsDetail@home.events.details":{templateUrl:"views/events/events_details_expenses_photo.html",controller:"EventsExpensesPhotoController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.surveys",{url:"/surveys",views:{"eventsDetail@home.events.details":{templateUrl:"views/surveys/events_details_surveys.html",controller:"eventsSurveysController"}},data:{shouldRememberInHistory:!1}}).state("home.events.details.surveys.add",{url:"/add",views:{"eventsDetail@home.events.details":{templateUrl:"views/surveys/events_details_surveys_add.html",controller:"eventsSurveysAddController"}},data:{shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.events.details.surveys.edit",{url:"/:surveyId/edit",views:{"eventsDetail@home.events.details":{templateUrl:"views/surveys/events_details_surveys_add.html",controller:"eventsSurveysEditController"}},data:{shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.tasks",{url:"/tasks",views:{"details@home":{templateUrl:"partials/tasks.html",controller:"TasksController"}}}).state("home.venues",{url:"/venues",views:{"details@home":{templateUrl:"views/venues/venues.html",controller:"VenuesController"}},data:{shouldRememberInHistory:!0}}).state("home.venues.add",{url:"/add",views:{"details@home":{templateUrl:"views/venues/venues_add.html",controller:"VenuesAddController"}},data:{shouldRememberInHistory:!1,parentShouldBeRemembered:!0}}).state("home.venues.details",{url:"/:venueId",views:{"details@home":{templateUrl:"views/venues/venues_details.html",controller:"VenuesDetailsController"}},data:{shouldRememberInHistory:!1}}).state("home.venues.details.about",{url:"/about",views:{"venuesDetail@home.venues.details":{templateUrl:"views/venues/venues_details_about.html",controller:"VenuesAboutController"}},data:{shouldRememberInHistory:!1}}).state("home.venues.details.map",{url:"/map",views:{"venuesDetail@home.venues.details":{templateUrl:"views/venues/venues_details_about_map.html",controller:"VenuesAboutMapController"}},data:{shouldRememberInHistory:!1,specificParent:"home.venues.details.about"}}).state("home.venues.details.analysis",{url:"/analysis",views:{"venuesDetail@home.venues.details":{templateUrl:"views/venues/venues_details_analysis.html",controller:"VenuesAnalysisController"}},data:{shouldRememberInHistory:!1}}).state("home.venues.details.photos",{url:"/photos",views:{"venuesDetail@home.venues.details":{templateUrl:"views/venues/venues_details_photos.html",controller:"VenuesPhotosController"}},data:{shouldRememberInHistory:!1}}).state("home.venues.details.photos.slider",{url:"/slider/{index:.*}",views:{"venuesDetail@home.venues.details":{templateUrl:"views/venues/venues_details_photos_slider.html",controller:"VenuesPhotoSliderController"}},data:{shouldRememberInHistory:!1}}).state("home.venues.details.comments",{url:"/comments",views:{"venuesDetail@home.venues.details":{templateUrl:"views/venues/venues_details_comments.html",controller:"VenuesCommentsController"}},data:{shouldRememberInHistory:!1}}).state("home.notifications",{url:"/notifications",views:{"details@home":{templateUrl:"partials/notifications.html",controller:"NotificationsController"}},data:{shouldRememberInHistory:!0}}).state("home.profile",{url:"/profile",views:{"details@home":{templateUrl:"partials/edit_profile.html",controller:"ProfileController"}},data:{shouldRememberInHistory:!0}}).state("home.forbidden",{url:"/forbidden_area",views:{"details@home":{templateUrl:"views/forbidden.html",controller:"ForbiddenController"}}})}).config(["$httpProvider",function($httpProvider){$httpProvider.defaults.useXDomain=!0,delete $httpProvider.defaults.headers.common["X-Requested-With"]}]).run(["$rootScope",function($rootScope){$rootScope.alert=function(text){alert(text)},scopic.injectConst($rootScope)}]),angular.module("brandscopicApp.services.permissions",["brandscopicApp.services"]),angular.module("brandscopicApp.constants",[]).service("ApiParams",function(){var url="http://stage.brandscopic.com/api/v1",port="";this.baseUrl=url+(""!=port?":"+port:"")}),angular.module("brandscopicApp.services",["ngResource","ngCookies","model.user","model.session","brandscopicApp.constants"]).service("UserService",["SessionService","CompanyService","User",function(SessionService,CompanyService,User){this.currentUser={isLogged:!1,email:"",auth_token:"",current_company_id:0,permissions:{}},this.isLogged=function(){var sessionData=SessionService.get("sessionData");return null!=sessionData},this.setUserPermissions=function(authToken,companyId){var credentials={company_id:companyId,auth_token:authToken},actions={success:function(permissions){return permissions}};User.permissions(credentials,actions)},this.permissionIsValid=function(permission){var canDo=!1;if(this.currentUser.permissions&&permission)for(var item,i=0;item=this.currentUser.permissions[i++];)if(item==permission){canDo=!0;break}return canDo}}]).service("CompanyService",function(){this.currentCompany={id:0,name:"[Choose Company]"},this.getCompanyId=function(){return this.currentCompany.id}}).service("UserInterface",function(){this.title="",this.hasMagnifierIcon=!1,this.hasAddIcon=!1,this.hasSaveIcon=!1,this.hasEditSurveyIcon=!1,this.hasCancelIcon=!1,this.hasMenuIcon=!0,this.hasDeleteIcon=!1,this.hasBackIcon=!1,this.hasCloseIcon=!1,this.searching=!1,this.AddIconState="",this.CloseState="",this.eventSubNav="",this.venueSubNav="",this.actionSave="",this.showEventSubNav=!0,this.showVenueSubNav=!0,this.hasCustomHomeClass=!1,this.EditIconUrl="",this.noData=!1,this.hasAddPhoto=!1,this.getDefaults=function(){var defaultUI={title:"",hasMagnifierIcon:!1,hasAddIcon:!1,hasSaveIcon:!1,hasEditSurveyIcon:!1,hasCancelIcon:!1,hasMenuIcon:!0,hasDeleteIcon:!1,hasEditIcon:!1,hasBackIcon:!1,hasCloseIcon:!1,searching:!1,AddIconState:"",CloseState:"",eventSubNav:"",venueSubNav:"",actionSave:"",showEventSubNav:!0,showVenueSubNav:!0,hasCustomHomeClass:!1,EditIconUrl:"",noData:!1,hasAddPhoto:!1};return defaultUI}}).service("LoginManager",["SessionService","UserService","CompanyService","Session","User",function(SessionService,UserService,CompanyService,Session){this.login=function(authToken,email,currentCompanyId,currentCompanyName,permissions){UserService.currentUser.auth_token=authToken,UserService.currentUser.email=email,UserService.currentUser.permissions=permissions,CompanyService.currentCompany.id=currentCompanyId,CompanyService.currentCompany.name=currentCompanyName;var sessionData=new SessionData(authToken,email,currentCompanyId,currentCompanyName,permissions);SessionService.put("sessionData",sessionData)},this.saveSession=function(loginData){SessionService.put("sessionData",loginData)},this.getCurrentSession=function(){return SessionService.get("sessionData")},this.initializeSystem=function(){if(!this.isLogged())return!1;var loginData=SessionService.get("sessionData");UserService.currentUser.auth_token=loginData.authToken,UserService.currentUser.email=loginData.email,UserService.currentUser.permissions=loginData.currentPermissions,CompanyService.currentCompany.id=loginData.currentCompanyId,CompanyService.currentCompany.name=loginData.currentCompanyName},this.logout=function(authToken,loggedOutCallback,errorLoggingOutCallback){var credentials={id:authToken},actions={success:function(){UserService.currentUser.auth_token="",UserService.currentUser.isLogged=!1,UserService.currentUser.email="",SessionService.remove("sessionData"),null!=loggedOutCallback&&loggedOutCallback()},error:function(){return UserService.currentUser.auth_token="",UserService.currentUser.isLogged=!1,UserService.currentUser.email="",SessionService.remove("sessionData"),null!=errorLoggingOut&&errorLoggingOutCallback(response),!1}};Session.logout(credentials,actions),UserService.currentUser.auth_token="",UserService.currentUser.isLogged=!1,UserService.currentUser.email="",SessionService.remove("sessionData"),null!=loggedOutCallback&&loggedOutCallback()},this.isLogged=function(){return null!=SessionService.get("sessionData")}}]).service("PermissionsHandler",["$state","UserService",function($state,UserService){this.handlePermissions=function(permissions){angular.forEach(permissions,function(permission){UserService.permissionIsValid(permission)||$state.go("home.forbidden")})}}]).value("version","0.1").value("loginPage","/login"),angular.module("brandscopicApp.controllers",["model.event","model.campaign","model.expense","model.comment","model.eventContact","model.eventTeam","model.contact","model.country","model.venue","highcharts-ng","model.notification","model.company","model.session"]).controller("MainController",["$scope","UserService","SessionService",function($scope,UserService){$scope.UserService=UserService,$scope.trigger=function(event,payload){$scope.$broadcast(event,payload)}}]).controller("LoginController",["$scope","$state","UserService","CompanyService","Company","User","SessionService","LoginManager","Session",function($scope,$state,UserService,CompanyService,Company,User,SessionService,LoginManager,Session){return LoginManager.isLogged()?void $state.go("home.dashboard"):($scope.shouldKeepLoggedIn=!1,$scope.sentEmail=!1,$scope.user={email:"mpescarmona@gmail.com",password:"Mario123"},$scope.wrongUser=null,$scope.validateApiUser=function(){var credentials={email:$scope.user.email,password:$scope.user.password},actions={success:function(login){$scope.wrongUser=!1;var authToken=login.data.auth_token,currentCompanyId=login.data.current_company_id,credentials={auth_token:authToken},action={success:function(companies){var credentials={company_id:currentCompanyId,auth_token:authToken},actions={success:function(permissions){UserService.currentUser.permissions=permissions;for(var company,i=0;company=companies[i++];)if(company.id==currentCompanyId){CompanyService.currentCompany.id=company.id,CompanyService.currentCompany.name=company.name,LoginManager.login(login.data.auth_token,$scope.user.email,company.id,company.name,permissions),$state.go("home.dashboard");break}}};User.permissions(credentials,actions)}};Company.all(credentials,action)},error:function(){$scope.wrongUser=!0,UserService.currentUser.auth_token="",UserService.currentUser.isLogged=!1,UserService.currentUser.email=""}};Session.login(credentials,actions)},$scope.forgotPassword=function(email){var credentials={email:email},actions={success:function(){UserService.currentUser.isLogged=!1,UserService.currentUser.email="",$scope.sentEmail=!0,$state.go("login")},error:function(){$scope.wrongUser=!0,UserService.currentUser.auth_token="",UserService.currentUser.isLogged=!1,UserService.currentUser.email="",$scope.sentEmail=!1}};User.forgotPassword(credentials,actions)},$scope.handleKeepMeLoggedInClicked=function(value){var storageType=value?"local":"session";SessionService.setStorageType(storageType)},$scope.keyUpClear=function(){this.nextSibiling.className=this.value.length?"type-reset hidden":"type-reset"},$scope.keyDownClear=function(){this.value="",this.netxSibiling.className="type-reset"},$scope.clickClear=function(){this.className="type-reset hidden",this.previousSibiling.value=""},void $scope.handleKeepMeLoggedInClicked($scope.shouldKeepLoggedIn))}]),angular.module("brandscopicApp.filters",[]).filter("interpolate",["version",function(version){return function(text){return String(text).replace(/\%VERSION\%/gm,version)}}]).filter("totalCount",function(){return function(input){if(input>1e3){var result=(input/1e3).toFixed(1).toString()+"K";return result}return input}}).filter("validatePermissions",function(){return function(array){if(null==array)return[];for(var filteredMembers=[],i=0;i<array.length;i++)array[i].visible!==!1&&filteredMembers.push(array[i]);return filteredMembers}}).filter("timeago",function(){return function(time,local,raw){if(!time)return"never";if(local||(local=Date.now()),angular.isDate(time)?time=time.getTime():"string"==typeof time&&(time=new Date(time).getTime()),angular.isDate(local)?local=local.getTime():"string"==typeof local&&(local=new Date(local).getTime()),"number"==typeof time&&"number"==typeof local){var offset=Math.abs((local-time)/1e3),span=[],MINUTE=60,HOUR=3600,DAY=86400,WEEK=604800,YEAR=31556926,DECADE=315569260;return span=MINUTE>=offset?["",raw?"now":"less than a minute"]:60*MINUTE>offset?[Math.round(Math.abs(offset/MINUTE)),"min"]:24*HOUR>offset?[Math.round(Math.abs(offset/HOUR)),"hour"]:7*DAY>offset?[Math.round(Math.abs(offset/DAY)),"day"]:52*WEEK>offset?[Math.round(Math.abs(offset/WEEK)),"week"]:10*YEAR>offset?[Math.round(Math.abs(offset/YEAR)),"year"]:100*DECADE>offset?[Math.round(Math.abs(offset/DECADE)),"decade"]:["","a long time"],span[1]+=0===span[0]||span[0]>1?"s":"",span=span.join(" "),raw===!0?span:local>=time?span+" ago":"in "+span}}}).filter("eventDate",function(){return function(time){if(!time)return"";angular.isDate(time)?time=time.getTime():"string"==typeof time&&(time=new Date(time));var result="",local=new Date,tomorrow=new Date(local.getTime()+864e5),months=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],days=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"];return result=time.getDate()===local.getDate()&&time.getMonth()===local.getMonth()&&time.getFullYear()===local.getFullYear()?"TODAY":time.getDate()===tomorrow.getDate()&&time.getMonth()===tomorrow.getMonth()&&time.getFullYear()===tomorrow.getFullYear()?"TOMORROW":days[time.getDay()]+", "+months[time.getMonth()]+" "+time.getDate()+" "+time.getFullYear()}}).filter("groupBy",function(){return function(list,group_by){var filtered=[],prev_item=null,group_changed=!1,firstOfGroup=group_by+"_CHANGED",lastOfGroup=group_by+"_LAST_OF_GROUP";return angular.forEach(list,function(item){group_changed=!1,null!==prev_item?prev_item[group_by]!==item[group_by]&&(group_changed=!0):group_changed=!0,group_changed?(item[firstOfGroup]=!0,null!==prev_item&&(prev_item[lastOfGroup]=!0)):item[firstOfGroup]=!1,filtered.push(item),prev_item=item}),filtered.length>0&&(filtered[filtered.length-1].lastOfGroup=!0),filtered}}).filter("limitWords",function(){return function(input,length){if(input){if(null===length)return input;var words=input.split(" "),sliceLength=words.length<length?words.length:length,slicedWords=words.slice(0,sliceLength);return slicedWords.join(" ")}}}).filter("unitedStatesFirst",function(){return function(countries){if(null==countries)return countries;for(var found=!1,us=null,newCountries=[],i=0;i<countries.length;i++)newCountries.push(countries[i]),"us"===countries[i].id.toLowerCase()&&(us=countries[i],found=!0);return found&&newCountries.splice(0,0,us),newCountries}}).filter("allowedNotifications",["UserService",function(UserService){function notificationShouldBeShown(notification){if(null==neededPermissionsMap[notification.type])return!0;for(var neededPermissions=neededPermissionsMap[notification.type],showNotification=!0,i=0;i<neededPermissions.length&&(showNotification=UserService.permissionIsValid(neededPermissions[i]),showNotification);i++);return showNotification}var neededPermissionsMap={event_recaps_due:["events"],event_recaps_late:["events"],event_recaps_pending:["events"],event_recaps_rejected:["events"],new_event:["events","events_show"]};return function(notifications){if(null!=notifications){for(var filteredNotifications=[],i=0;i<notifications.length;i++)notificationShouldBeShown(notifications[i])&&filteredNotifications.push(notifications[i]);return filteredNotifications}}}]),angular.module("brandscopicApp.directives",["brandscopicApp.services"]).directive("appVersion",["version",function(version){return function(scope,elm){elm.text(version)}}]).directive("passwordValidate",function(){return{require:"ngModel",link:function(scope,elm,attrs,ctrl){ctrl.$parsers.unshift(function(viewValue){return scope.pwdValidLength=viewValue&&viewValue.length>=8?"valid":void 0,scope.pwdHasLetter=viewValue&&/[A-z]/.test(viewValue)?"valid":void 0,scope.pwdHasNumber=viewValue&&/\d/.test(viewValue)?"valid":void 0,scope.pwdValidLength&&scope.pwdHasLetter&&scope.pwdHasNumber?(ctrl.$setValidity("pwd",!0),viewValue):void ctrl.$setValidity("pwd",!1)})}}}).directive("goTo",function($window){return{restrict:"A",link:function(scope){scope.goTo=function(path){$window.location.href=path}}}}).directive("stopEvent",function(){return{restrict:"A",link:function(_scope,$el,attr){$el.on(attr.stopEvent,function(e){e.stopPropagation()})}}}).directive("headerSaveAction",function(){return{restrict:"A",link:function(scope,$el,attr){scope.$eval(attr.save)?$el.on("click",function(){$("[data-trigger-on-header=save]").first().click()}):$el.on("click",function(){$("[data-trigger-on-header=edit]").first().click()})}}}).directive("headerBackAction",["$window","$state",function($window,$state){return{restrict:"A",link:function(scope,$el){$el.on("click",function(){if($state.$current.data&&$state.$current.data.specificParent)return void $state.go($state.$current.data.specificParent);for(var destinationState=$state.$current.parent;destinationState.parent&&$state.$current.data&&!$state.$current.data.parentShouldBeRemembered&&(!destinationState.data||!destinationState.data.shouldRememberInHistory);)destinationState=destinationState.parent;$state.go(destinationState)})}}}]).directive("whenScrolled",function(){return function(scope,elm,attr){var raw=elm[0];elm.bind("scroll",function(){raw.scrollTop+raw.offsetHeight>=raw.scrollHeight&&scope.$apply(attr.whenScrolled)})}}).directive("redirectTo",function($window){return function(scope,el){el.on("click",function(){$window.location.href=this.getAttribute("redirect-to")})}}).directive("redirectToState",function($state){return function(scope,el){el.on("click",function(){$state.go(this.getAttribute("redirect-to-state"))})}}).directive("inputReset",function(){return function(scope,el){el.on("keyup",function(){var isEmpty=!this.querySelector("input").value.length;null!=this.querySelector("a")&&(this.querySelector("a").className=isEmpty?"type-reset hidden":"type-reset")}),el.on("keydown",function(e){27==e.keyCode&&(this.querySelector("a").className="type-reset hidden",this.querySelector("input").value="")}),el.find("a").on("click",function(e){e.preventDefault(),this.className="type-reset hidden",this.parentElement.querySelector("input").value=""}),el.find("input").on("change",function(){var isEmpty=!this.value.length;null!=this.parentElement.querySelector("a")&&(this.parentElement.querySelector("a").className=isEmpty?"type-reset hidden":"type-reset")})}}).directive("needsPermissions",["UserService","$injector","$state","$timeout",function(UserService,$injector,$state,$timeout){return{restrict:"AE",link:function(scope,element,attrs){function handlePermissions(permissions,permissionsHandler){if(permissions instanceof Array)for(var i=0;i<permissions.length;i++){var permission=permissions[i];permissionsHandler(permission)}else if(null!==permissions&&"object"==typeof permissions)for(var key in permissions)permissionsHandler(key,permissions[key])}function doWork(){var permissionsServiceName=attrs.provider;if(null==permissionsServiceName)throw"The permissions directive lacks a provider";var permissionsService=$injector.get(permissionsServiceName);if(null==permissionsService)throw"The permissions provider could not be found";handlePermissions(permissionsService.pagePermissions,function(permission){return UserService.permissionIsValid(permission)?void 0:void $state.go("home.forbidden")}),handlePermissions(permissionsService.elementsVisiblePermissions,function(key,permissions){var elementsShouldBeVisible=!0;if(permissions instanceof Array){for(var i=0;i<permissions.length;i++)if(!UserService.permissionIsValid(permissions[i])){elementsShouldBeVisible=!1;break}}else elementsShouldBeVisible=permissions.customHandler();elementsShouldBeVisible||element.find(key).hide()}),handlePermissions(permissionsService.hyperlinksEnabledPermissions,function(key,permissions){var elementsShouldBeLinkable=!0;if(permissions instanceof Array){for(var i=0;i<permissions.length;i++)if(!UserService.permissionIsValid(permissions[i])){elementsShouldBeLinkable=!1;break}}else elementsShouldBeLinkable=permissions.customHandler();elementsShouldBeLinkable||element.find(key).off()}),scope.customPermissionsHandler&&scope.customPermissionsHandler()}if(scope.getObservableProperties)for(var propertiesToWatch=scope.getObservableProperties(),i=0;i<propertiesToWatch.length;i++)scope.$watch(propertiesToWatch[i],function(){doWork()},!0);$timeout(function(){doWork()},0)}}}]).directive("showPhoto",function(){return function(scope,$el){$el.on("change",function(e){var reader=new FileReader;reader.onload=function(e){document.querySelector(".fileUpload img.show-preview").src=e.target.result},reader.readAsDataURL(e.target.files[0])})}}).directive("loadingData",function(){return{restrict:"E",template:""}}).directive("onlyAcceptNumbers",function(){return{restrict:"A",link:function($scope,element){element.on("keydown",function(e){var key=e.keyCode||e.charCode;return key>=48&&57>=key})}}}).directive("alertBox",["$compile",function($compile){return{restrict:"A",scope:{content:"@"},link:function($scope,element){$scope.$watch("content",function(value){element.html(value),$compile(element.contents())($scope.$parent)})}}}]).directive("showOnce",["SessionService",function(SessionService){return{link:function(scope,element,attrs){var elementId=attrs.showOnce,notFirstAccess=SessionService.get(elementId);notFirstAccess?element.hide():(SessionService.put(elementId,!0),element.show())}}}]).directive("keepDatesOnTop",["$window",function($window){return{link:function(scope,element){var sticky_relocate=function(){var dateBars=$(".dividersBar").filter(function(){return null!=this&&!$(this).hasClass("ng-hide")}).sort(function(a,b){var aTop=$(a).offset().top,bTop=$(b).offset().top;return aTop>bTop?1:bTop>bTop?-1:0}),fixedBar=$("#fixedBar"),window_top=angular.element($window).scrollTop(),lastPassedDate=findLastPassedDate(dateBars,window_top+46),fixedBar=$("#fixedBar");null===lastPassedDate?fixedBar.hide():(fixedBar.show(),fixedBar.html(lastPassedDate))},findLastPassedDate=function(dateBars,windowTop){for(var i=0,lastDate=null;i<dateBars.length&&$(dateBars[i]).offset().top<=windowTop;)i++;return i>0?$(dateBars[i-1]).html():lastDate},angElement=angular.element(element);0===$("#fixedBar").length&&angElement.append('<div id="fixedBar" class="fixedDividersBar"></div>'),angular.element($window).scroll(sticky_relocate),sticky_relocate()}}}]),angular.module("brandscopicApp.animations",[]).animation(".slide-animation",function(){return{addClass:function(element,className,done){var scope=element.scope();if("ng-hide"==className){var finishPoint=element.parent().width();"right"!==scope.direction&&(finishPoint=-finishPoint),TweenMax.to(element,.5,{left:finishPoint,onComplete:done})}else done()},removeClass:function(element,className,done){var scope=element.scope();if("ng-hide"==className){element.removeClass("ng-hide");var startPoint=element.parent().width();"right"===scope.direction&&(startPoint=-startPoint),TweenMax.set(element,{left:startPoint}),TweenMax.to(element,.5,{left:0,onComplete:done})}else done()}}});